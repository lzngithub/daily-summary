# 设计理念（2021.10.01）

设计理念：快速响应
制约瓶颈： CPU 和 IO

## CPU 瓶颈

主流浏览器刷新频率为 60Hz，即（1000ms/60Hz）16.6ms 浏览器刷新一次。js 可以操作 dom 元素，GUI 渲染线程和 js 线程是互斥，当我们 js 执行时间超多一帧的时间，这一次的浏览器刷新就不会进行样式布局和样式绘制了,造成卡顿，给人视觉上不好的体验

> 怎么解决这个问题？

React 是这样做的，在浏览器一帧（16.6ms）中预留一些时间（5ms）给 js 线程，react 利用这部分时间更新组件。

当预留的时间不够用时，React 将线程控制权交还给浏览器使其有时间渲染 UI，React 则等待下一帧时间到来继续被中断的工作。

React 这种做法称为时间切片

- 时间切片：将长任务分拆到每一帧中，像蚂蚁搬家一样一次执行一小段任务的操作

时间切片的关键是：将同步的更新变为可中断的异步更新（后面再说具体实现）

## IO 的瓶颈

网络延迟我们我们没办法控制，但我们可以减少用户对网络延迟的感知

将人机交互研究的结果整合到真实的 UI 中

在 react 源码内部，将同步的更新变为异步可中断更新
