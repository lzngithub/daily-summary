# git 基本使用

开源的分布式版本控制系统

## 1 基本配置

基本配置都是配置全局的，这是为了不用每个项目单独配置，如果想对某个项目单独配置，可以在每个项目的根目录下的 ./git/config 文件进行单独配置

配置命令格式大部分长下面这样，

```shell
git config <位置> <配置名> <配置值>
```

### 1.1 用户信息

配置开发人员的用户信息

```shell
git config --global user.name "Liang Zn"
git config --global user.email "xxx@xx.com"
```

### 1.2 环境配置

```shell
git config --global core.ignorecase false # 不忽略文件文件名大小写
git config --global core.antocrlf false   # 不把文件换行符换成crlf，windows默认换行和mac的不一样
git config --global core.filemode false   # 不区分文件的执行权限，因为windows平台设其他平台的文件权限系统不一样
```

### 2 链接远程仓库

初始化仓库，并把文件添加到库中，连接远程仓库，推送代码

```shell
git init
git add .
git commit -m "feat: 第一次提交代码"
git branch -M main
git remote add origin <仓库地址> # http方式
git push origin main
```

## 3 代码提交

做完一件事情即可提交代码，提交的备注文字尽量准确、简洁，不要同时提交多件事情的代码。

提交 commit 的注释文字，需要简单扼要，且充分考虑影响范围，不要遗漏提交功能实现的描述。

Commit 注释规范，不同情形下区别：

- feat【新增】: Feature 的缩写, 新的功能或特性
- fix【bug 修复】: bug 的修复
- docs【文档】: 文件修改, 比如修改应用了 ngDoc 的项目的 ngDoc 内容
- style【界面】: 格式修改. 比如改变缩进, 空格, 删除多余的空行, 补上漏掉的分号. 总之, 就是不影响代码含义和功能的修改
- refractor【重构】: 代码重构. 一些不算修复 bug 也没有加入新功能的代码修改
- perf【优化】: Performance 的缩写, 提升代码性能
- test【测试】: 测试文件的修改
- chore【其它】: 其他的小改动. 一般为仅仅一两行的改动, 或者连续几次提交的小改动属于这种

## 4 git 分支

分支功能是 git 最为强大的功能之一，它能够让你并发地在多个场景下进行开发。并且可以让你同时开发不同功能而不冲突，用于区分功能或版本

### 4.1 分支分类

- master：主分支 可发布的稳定版分支，存放对外发布的版本，任何时候在这个分支拿到的，都是稳定的发布版本
- develop：开发分支用于日常开发，存放最新的开发版，公共的开发主线分支，feature 功能分支的代码开发完成后，经过 code review 后会合并到此分支
- feature branch：功能分支 一般是从 develop 开发分支上检出(checkout)
- hotfix branch：补丁分支 紧急修复，一般是用于修复上线后的生产环境的问题
- release branch：预发分支 测试、发布主线，此分支是从 develop 分支上检出(checkout), 一般是提测阶段会使用该分支的代码

主分支命名为 master，有且只有一个分支，所有正式版本都必须从 master 分支发布，并且又相关发布的 Tag，master 分支只能从其它分支合并，不能在这个分支上修改，禁止直接向 master 分支 Push 代码；

日常开发分支命名为 develop，有且只有一个分支，原则上并行开发的时候，develop 分支承担改动最大的方向，比如进行大规模的代码重构、界面框架替换、大版本升级或者日常常规迭代升级等等。

### 4.2 code review

在编写代码的时候，为了代码的高质量与开发人员的知识共享，通常会加上代码审查也就是 code review 环节。这个环节是借助 merge request 或者 pull request 来做到的，所以我们提交的 commit 记录应该尽量保持为一个，这样的好处有很多：

方便代码审核者进行 code review，只需要看这一个 commit 记录的逻辑即可, 万一该 commit 的代码导致出现问题，我们可以只针对这个 commit 进行快速回退。 一个功能保持一个 commit 记录如果遇到需要对这个功能提前提交到某些环境比如生产环境上，我们可以快速用过 cherry-pick 命令，在对应的分支上"重现"该提交记录，达到提前提交的目的。

也许你会有疑问，单个功能保持一个 commit 记录与 commit 提交记录尽量保持较细的粒度这一原则是否相悖，笔者觉得并没有冲突，因为这两个 git 协作要求是基于不同的角度来看待问题的，对于自己开发的分支上，我们需要保持每个提交的粒度在一个 commit 做一个修改，这样有利于我们记录工作内容与方便自己在本分支上做回滚，但是对于一个软件开发的主分支来说，它上面的提交应该是以功能为单位的，而无需关心这个功能内开发人员开发这个功能做了多少次修改。

面对这种情况，我们会使用 rebase 命令，也就是衍合(变基)操作。所谓衍合就是将你此分支上的 commit 提交，按顺序重新在某个分支上的某个基础点重新"演绎"一次，而这个重新"演绎"重新提交的 commit 记录与原来的 commit 提交会有些许不同，不同点在于 commit 的 HashId 会不同，但是提交内容是一样的。

rebase 命令提供了交互式的界面，并且提供多种的命令让你能够将多个 commit 记录合并为一个，从而达到我们单一功能保持一个 commit 记录的目的，保持提交历史的清爽。
